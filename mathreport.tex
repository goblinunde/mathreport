% â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
% â•‘                        MindFlow åŠŸèƒ½æ¼”ç¤ºæ–‡æ¡£                               â•‘
% â•‘                       Report æ¨¡å¼ + å®¡ç¨¿ + æ°´å°                            â•‘
% â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
% â•‘  æ–‡ä»¶: mathreport.tex                                                      â•‘
% â•‘  è¯´æ˜: æ¼”ç¤º review å®¡ç¨¿æ¨¡å¼ã€æ°´å°åŠŸèƒ½ã€æ‰¹æ³¨ç³»ç»Ÿ                            â•‘
% â•‘  ç¼–è¯‘: xelatex mathreport.tex                                              â•‘
% â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
\documentclass[linux, report, review]{mindflow}
%
% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
% â”ƒ                           ğŸ“‹ ç±»é€‰é¡¹å®Œæ•´å‚è€ƒ                               â”ƒ
% â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
%
% â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
% â”‚ ã€æ–‡æ¡£æ¨¡å¼ã€‘ä¸‰é€‰ä¸€                                                       â”‚
% â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
% â”‚  note   â”‚ åŸºäº ctexart  â”‚ ç¬”è®°æ¨¡å¼ï¼Œ\section ä¸ºé¡¶å±‚                     â”‚
% â”‚  book   â”‚ åŸºäº ctexbook â”‚ ä¹¦ç±æ¨¡å¼ï¼Œæ”¯æŒ \chapter                       â”‚
% â”‚  report â”‚ åŸºäº ctexrep  â”‚ æŠ¥å‘Šæ¨¡å¼ âœ“ï¼Œ\section å‘ˆç°å¤§æ ‡é¢˜æ ·å¼           â”‚
% â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
%
% â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
% â”‚ ã€å¹³å°é€‚é…ã€‘linux âœ“ / mac / win                                          â”‚
% â”‚ ã€å®¡ç¨¿æ¨¡å¼ã€‘review âœ“ â†’ å¯ç”¨è¡Œå·æ˜¾ç¤ºï¼Œæ–¹ä¾¿æ‰¹æ³¨å®šä½                        â”‚
% â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
%
% â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
% â”‚ ã€Section æ ·å¼ã€‘åé€‰ä¸€                                                   â”‚
% â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
% â”‚  secstyle-classic     â”‚  è“è‰²ç¼–å·å— + æµ…è“èƒŒæ™¯ (é»˜è®¤)                   â”‚
% â”‚  secstyle-modern      â”‚  å¤§å·ç¼–å· + æ¸å˜åº•è¾¹çº¿                          â”‚
% â”‚  secstyle-minimal     â”‚  æç®€ï¼šå·¦ä¾§ç«–çº¿ + çº¯æ–‡æœ¬                        â”‚
% â”‚  secstyle-boxed       â”‚  è¾¹æ¡†å¡ç‰‡ + é˜´å½±                                â”‚
% â”‚  secstyle-neon        â”‚  ğŸŸ¢ éœ“è™¹å‘å…‰ (èµ›åšæœ‹å…‹)                         â”‚
% â”‚  secstyle-terminal    â”‚  ğŸ–¥ï¸ ç»ˆç«¯é£æ ¼ (Hacker)                           â”‚
% â”‚  secstyle-gradient    â”‚  ğŸŒˆ æ¸å˜èƒŒæ™¯ (ç§‘æŠ€æ„Ÿ)                           â”‚
% â”‚  secstyle-elegant     â”‚  âœ¨ é‡‘è‰²è£…é¥° (å­¦æœ¯å…¸é›…)                         â”‚
% â”‚  secstyle-blueprint   â”‚  ğŸ“ è“å›¾ç½‘æ ¼ (å·¥ç¨‹å¸ˆ)                           â”‚
% â”‚  secstyle-ribbon      â”‚  ğŸ—ï¸ æŠ˜å ä¸å¸¦ (ç²¾è‡´å¡ç‰‡)                         â”‚
% â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
%
% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
% â”ƒ                            ğŸ’§ æ°´å°åŠŸèƒ½è¯¦è§£                                â”ƒ
% â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
%
% ã€æ–‡æœ¬æ°´å°ã€‘ \mfWatermarkText[é¢œè‰²][ç¼©æ”¾]{æ–‡å­—}
%   å‚æ•°: é¢œè‰²(å¯é€‰ï¼Œé»˜è®¤gray!25) | ç¼©æ”¾(å¯é€‰ï¼Œé»˜è®¤4) | æ–‡å­—(å¿…éœ€)
%
%   ç¤ºä¾‹:
%     \mfWatermarkText{DRAFT}              % é»˜è®¤ç°è‰²è‰ç¨¿
%     \mfWatermarkText[red!15]{ç»å¯†}       % çº¢è‰²ç»å¯†
%     \mfWatermarkText[blue!10][6]{å†…éƒ¨}   % è“è‰²å¤§å·
%
% ã€å›¾ç‰‡æ°´å°ã€‘ \mfWatermarkImage{å›¾ç‰‡è·¯å¾„}
%   ç¤ºä¾‹: \mfWatermarkImage{figure/logo.png}
%
% ã€é»˜è®¤ã€‘æ°´å°é»˜è®¤ä¸æ˜¾ç¤ºï¼Œè°ƒç”¨ä¸Šè¿°å‘½ä»¤åæ‰å¯ç”¨
%
% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
% â”ƒ                            ğŸ“ æ‰¹æ³¨ç³»ç»Ÿè¯´æ˜                                â”ƒ
% â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
%
%   \todo{å†…å®¹}     â†’ ğŸŸ  å¾…åŠï¼šæ©™è‰²è¾¹æ¡†ï¼Œæ ‡è®°æœªå®Œæˆä»»åŠ¡
%   \fixme{å†…å®¹}    â†’ ğŸ”´ ä¿®æ­£ï¼šçº¢è‰²è¾¹æ¡†ï¼Œæ ‡è®°é”™è¯¯æˆ–é—®é¢˜
%   \notebox{å†…å®¹}  â†’ ğŸ”µ å¤‡æ³¨ï¼šè“è‰²è¾¹æ¡†ï¼Œè¡¥å……è¯´æ˜
%
%   ğŸ’¡ é…åˆ review æ¨¡å¼çš„è¡Œå·ï¼Œå¯ç²¾ç¡®å®šä½æ‰¹æ³¨ä½ç½®
%
% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

\title{å®éªŒæŠ¥å‘Šï¼šä¸€ç»´çƒ­æ–¹ç¨‹çš„æ•°å€¼è§£æ³•}
\author{MindFlow å®éªŒå‘˜}
\date{\today}

% å¯ç”¨æ–‡æœ¬æ°´å°æ¼”ç¤º
\mfWatermarkText[gray!15][2.5]{CJX}

\begin{document}

\maketitle
\mftableofcontents

% =========================================================
\section{å®éªŒç›®çš„}
% =========================================================

\todo{å¾…è¡¥å……ï¼šå¢åŠ å®éªŒçš„å·¥ç¨‹æ„ä¹‰å’Œåº”ç”¨åœºæ™¯æè¿°}

æœ¬å®éªŒçš„ç›®æ ‡ï¼š
\begin{enumerate}
    \item ç†è§£æŠ›ç‰©å‹ PDE çš„å·®åˆ†æ ¼å¼åŸç†
    \item å®ç°æ˜¾å¼æ¬§æ‹‰æ ¼å¼ (FTCS) ä¸éšå¼æ ¼å¼ (Backward Euler)
    \item éªŒè¯æ•°å€¼è§£çš„ç¨³å®šæ€§æ¡ä»¶ä¸æ”¶æ•›é˜¶
    \item æ¯”è¾ƒä¸åŒæ ¼å¼çš„è®¡ç®—æ•ˆç‡
\end{enumerate}

% =========================================================
\section{é—®é¢˜æè¿°}
% =========================================================

æ±‚è§£å¦‚ä¸‹ä¸€ç»´çƒ­ä¼ å¯¼æ–¹ç¨‹åˆè¾¹å€¼é—®é¢˜ï¼š
\begin{align}
    \pd{u}{t} &= \alpha \pdd{u}{x}, \quad 0 < x < L, \quad t > 0 \\
    u(x, 0) &= \sin(\pi x / L) \quad \text{(åˆå§‹æ¡ä»¶)} \\
    u(0, t) &= u(L, t) = 0 \quad \text{(Dirichlet è¾¹ç•Œæ¡ä»¶)}
\end{align}

\begin{defnnew}{ç²¾ç¡®è§£}
    åˆ©ç”¨åˆ†ç¦»å˜é‡æ³•å¯å¾—ç²¾ç¡®è§£ï¼š
    \[
        u(x, t) = e^{-\alpha (\pi/L)^2 t} \sin(\pi x / L)
    \]
    è¿™æ˜¯ä¸€ä¸ªæŒ‡æ•°è¡°å‡çš„æ­£å¼¦æ³¢ï¼Œè¡°å‡ç‡ç”±çƒ­æ‰©æ•£ç³»æ•° $\alpha$ å†³å®šã€‚
\end{defnnew}

\fixme{ç¬¬ 2.1 èŠ‚çš„æ¨å¯¼è¿‡ç¨‹éœ€è¦è¡¥å……å®Œæ•´çš„åˆ†ç¦»å˜é‡æ³•æ­¥éª¤}

\newpage
% =========================================================
\section{æ•°å€¼æ–¹æ³•}
% =========================================================

\subsection{æ˜¾å¼æ ¼å¼ (FTCS)}

\begin{center}
	\papyrus{%
		\begin{minipage}{0.7\textwidth}
			\textbf{éº¦å…‹æ–¯éŸ¦æ–¹ç¨‹ç»„}\\[0.3em]
			$\nabla \cdot \vec{E} = \frac{\rho}{\varepsilon_0}$, \quad
			$\nabla \cdot \vec{B} = 0$\\[0.2em]
			$\nabla \times \vec{E} = -\frac{\partial \vec{B}}{\partial t}$, \quad
			$\nabla \times \vec{B} = \mu_0 \vec{J} + \mu_0 \varepsilon_0 \frac{\partial \vec{E}}{\partial t}$
		\end{minipage}
	}
\end{center}

å¯¹æ—¶é—´é‡‡ç”¨å‘å‰å·®åˆ†ï¼Œç©ºé—´é‡‡ç”¨ä¸­å¿ƒå·®åˆ†ï¼š
\[
    \frac{u_i^{n+1} - u_i^n}{\Delta t} = \alpha \frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{\Delta x^2}
\]

ä»¤ç½‘æ ¼æ¯” $r = \frac{\alpha \Delta t}{\Delta x^2}$ï¼Œè¿­ä»£å…¬å¼ä¸ºï¼š
\[
    u_i^{n+1} = r u_{i+1}^n + (1 - 2r) u_i^n + r u_{i-1}^n
\]

\begin{warning}{ç¨³å®šæ€§æ¡ä»¶}
    FTCS æ ¼å¼æ˜¯æ¡ä»¶ç¨³å®šçš„ï¼ŒVon Neumann ç¨³å®šæ€§åˆ†æè¡¨æ˜å¿…é¡»æ»¡è¶³ï¼š
    \[
        r = \frac{\alpha \Delta t}{\Delta x^2} \le \frac{1}{2}
    \]
    å¦åˆ™æ•°å€¼è§£å°†äº§ç”Ÿéœ‡è¡å¹¶å‘æ•£ã€‚è¿™ä¸¥æ ¼é™åˆ¶äº†æ—¶é—´æ­¥é•¿çš„é€‰å–ã€‚
\end{warning}

\subsection{éšå¼æ ¼å¼ (Backward Euler)}

\notebox{éšå¼æ ¼å¼æ— æ¡ä»¶ç¨³å®šï¼Œä½†éœ€è¦æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œè®¡ç®—é‡æ›´å¤§}

å¯¹æ—¶é—´é‡‡ç”¨å‘åå·®åˆ†ï¼š
\[
    \frac{u_i^{n+1} - u_i^n}{\Delta t} = \alpha \frac{u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}}{\Delta x^2}
\]

æ•´ç†å¾—ä¸‰å¯¹è§’æ–¹ç¨‹ç»„ $A \vect{u}^{n+1} = \vect{u}^n$ï¼Œå¯ç”¨ Thomas ç®—æ³•é«˜æ•ˆæ±‚è§£ã€‚

% =========================================================
\section{å®éªŒç»“æœ}
% =========================================================

\subsection{ç¨³å®šæ€§éªŒè¯}

é€‰å–å‚æ•° $L=1$, $\alpha=0.01$, $\Delta x = 0.1$ï¼Œæµ‹è¯•ä¸åŒç½‘æ ¼æ¯”çš„æ•ˆæœã€‚

\begin{figurerow}{ä¸åŒç½‘æ ¼æ¯”ä¸‹çš„æ•°å€¼è§£}[2]
    \figitem{figure/py2.png}{$r=0.4$ (ç¨³å®š)}
    \figitem{figure/py3.png}{$r=0.6$ (å‘æ•£)}
\end{figurerow}

\subsection{è¯¯å·®åˆ†æ}

\begin{theoremnew}{æˆªæ–­è¯¯å·®}
    FTCS æ ¼å¼çš„å±€éƒ¨æˆªæ–­è¯¯å·®ä¸º $O(\Delta t) + O(\Delta x^2)$ï¼Œå³æ—¶é—´ä¸€é˜¶ã€ç©ºé—´äºŒé˜¶ç²¾åº¦ã€‚
\end{theoremnew}

ä¸‹è¡¨è®°å½•äº†ä¸åŒæ—¶ç©ºæ­¥é•¿ä¸‹çš„æœ€å¤§è¯¯å·® $E_\infty = \max_{i} |u_i^N - u_{exact}(x_i)|$ï¼š

\begin{table}[H]
    \centering
    \caption{è¯¯å·®æ”¶æ•›è¡¨}
    \begin{tabular}{cccc}
        \toprule
        $\Delta x$ & $\Delta t$ & $E_\infty$ & æ”¶æ•›é˜¶ \\
        \midrule
        0.100 & 0.0010 & 1.23e-3 & - \\
        0.050 & 0.00025 & 3.05e-4 & 2.01 \\
        0.025 & 0.00006 & 7.61e-5 & 2.00 \\
        0.0125 & 0.000015 & 1.90e-5 & 2.00 \\
        \bottomrule
    \end{tabular}
\end{table}

\begin{tip}{è¯¯å·®åˆ†ææŠ€å·§}
    æ”¶æ•›é˜¶å¯ç”¨å…¬å¼ $p = \log_2(E_h / E_{h/2})$ è®¡ç®—ã€‚è‹¥ç»“æœæ¥è¿‘ 2ï¼Œè¯´æ˜ç©ºé—´äºŒé˜¶ç²¾åº¦å¾—åˆ°éªŒè¯ã€‚
\end{tip}

% =========================================================
\section{ç»“è®ºä¸è®¨è®º}
% =========================================================

\begin{conclusion}{å®éªŒç»“è®º}
    \begin{enumerate}
        \item \textbf{FTCS æ ¼å¼}ï¼šå®ç°ç®€å•ã€è®¡ç®—é«˜æ•ˆï¼Œä½†å— $r \le 0.5$ ç¨³å®šæ€§æ¡ä»¶é™åˆ¶
        \item \textbf{è¯¯å·®éªŒè¯}ï¼šå®éªŒç»“æœéªŒè¯äº† $O(\Delta x^2 + \Delta t)$ çš„ç†è®ºæˆªæ–­è¯¯å·®é˜¶
        \item \textbf{å‘æ•£ç°è±¡}ï¼šåœ¨ç½‘æ ¼æ¯” $r > 0.5$ æ—¶ç¡®å®è§‚å¯Ÿåˆ°æ•°å€¼å‘æ•£ï¼Œä¸ç†è®ºåˆ†æä¸€è‡´
        \item \textbf{éšå¼æ ¼å¼}ï¼šæ— æ¡ä»¶ç¨³å®šï¼Œé€‚ç”¨äºåˆšæ€§é—®é¢˜ï¼Œä½†è®¡ç®—æˆæœ¬æ›´é«˜
    \end{enumerate}
\end{conclusion}

\todo{åç»­å·¥ä½œï¼šå®ç° Crank-Nicolson æ ¼å¼ (æ—¶é—´äºŒé˜¶ç²¾åº¦) å¹¶è¿›è¡Œå¯¹æ¯”å®éªŒ}

% =========================================================
\section{é™„å½•ï¼šæ ¸å¿ƒä»£ç }
% =========================================================

\begin{codeblock}[python]{FTCS æ ¼å¼å®ç°}
import numpy as np

def heat_ftcs(L, T, nx, nt, alpha):
    """
    ä½¿ç”¨ FTCS æ ¼å¼æ±‚è§£ä¸€ç»´çƒ­æ–¹ç¨‹
    
    Parameters:
        L: ç©ºé—´åŸŸé•¿åº¦
        T: æ—¶é—´åŸŸé•¿åº¦  
        nx: ç©ºé—´ç½‘æ ¼ç‚¹æ•°
        nt: æ—¶é—´æ­¥æ•°
        alpha: çƒ­æ‰©æ•£ç³»æ•°
    
    Returns:
        u: æœ€ç»ˆæ—¶åˆ»çš„æ•°å€¼è§£
    """
    dx = L / (nx - 1)
    dt = T / (nt - 1)
    r = alpha * dt / dx**2
    
    # ç¨³å®šæ€§æ£€æŸ¥
    if r > 0.5:
        print(f"Warning: r={r:.3f} > 0.5, æ ¼å¼ä¸ç¨³å®š!")
    
    # åˆå§‹æ¡ä»¶
    x = np.linspace(0, L, nx)
    u = np.sin(np.pi * x / L)
    
    # æ—¶é—´æ¨è¿›
    for n in range(1, nt):
        u_new = u.copy()
        u_new[1:-1] = r*u[2:] + (1-2*r)*u[1:-1] + r*u[:-2]
        u = u_new
    
    return u
\end{codeblock}

\begin{codeblock}[python]{è¯¯å·®è®¡ç®—ä¸å¯è§†åŒ–}
import matplotlib.pyplot as plt

def compute_error(u_num, u_exact):
    """è®¡ç®—æœ€å¤§èŒƒæ•°è¯¯å·®"""
    return np.max(np.abs(u_num - u_exact))

# å‚æ•°è®¾ç½®
L, T, alpha = 1.0, 0.1, 0.01
nx, nt = 101, 1001

# æ•°å€¼è§£
u_num = heat_ftcs(L, T, nx, nt, alpha)

# ç²¾ç¡®è§£
x = np.linspace(0, L, nx)
u_exact = np.exp(-alpha * (np.pi/L)**2 * T) * np.sin(np.pi * x / L)

# è¯¯å·®
error = compute_error(u_num, u_exact)
print(f"Max error: {error:.6e}")
\end{codeblock}

% =========================================================
% æ¼”ç¤ºï¼šå–æ¶ˆæ°´å°
% =========================================================
% å¦‚æœè¦å–æ¶ˆæ°´å°ï¼Œå¯åœ¨æ–‡æ¡£æœ«å°¾æ·»åŠ ä»¥ä¸‹å‘½ä»¤ï¼š
% \DraftwatermarkOptions{stamp=false}

\end{document}
